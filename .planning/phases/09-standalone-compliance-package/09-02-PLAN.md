# 09-02: Standalone Compliance Server Entry Point

## Objective
Create a standalone server entry point that runs only compliance-related APIs, deployable independently from the full Vesla ERP.

## Implementation

### Task 1: Create Standalone Entry Point

Create `web-erp-app/backend/src/standalone-compliance.ts`:

```typescript
/**
 * Standalone Compliance Server
 * 
 * Minimal Express server exposing only UAE compliance APIs.
 * Can be deployed independently without full ERP installation.
 * 
 * Included APIs:
 * - /api/compliance-portal  (Phase 8)
 * - /api/corporate-tax      (Phase 9)
 * - /api/einvoice/*         (Phases 6-7)
 * - /api/payroll            (Phase 5)
 * - /api/finance/compliance-config (Phase 1)
 * - /api/health             (Health check)
 */
```

### Task 2: Create Standalone Routes Setup

Create `web-erp-app/backend/src/setup/standalone-routes.setup.ts`:

Only register compliance-related routes:
- compliance-portal.routes
- corporate-tax.routes
- einvoice-transmission.routes
- einvoice-export.routes
- payroll.routes
- finance/compliance-config.routes
- finance/tax-configuration.routes
- health.routes
- auth.routes (for authentication)

### Task 3: Create Docker Configuration

Create `web-erp-app/backend/Dockerfile.compliance`:

```dockerfile
FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY dist/ ./dist/
COPY prisma/ ./prisma/
ENV NODE_ENV=production
ENV COMPLIANCE_MODE=standalone
EXPOSE 3001
CMD ["node", "dist/standalone-compliance.js"]
```

### Task 4: Environment Configuration

Add to `.env.example`:
```
# Standalone Compliance Mode
COMPLIANCE_MODE=standalone
COMPLIANCE_PORT=3001
```

## Files to Create

| File | Description |
|------|-------------|
| `src/standalone-compliance.ts` | Standalone server entry point |
| `src/setup/standalone-routes.setup.ts` | Compliance-only route registration |
| `Dockerfile.compliance` | Docker image for standalone deployment |

## Success Criteria

1. `npm run start:compliance` starts standalone server on port 3001
2. Only compliance APIs are exposed (no ERP routes)
3. Docker image builds and runs independently
4. Health check at `/api/health` works
